<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‡¼ì¸ ê³µì¥ - AI ì´ë¯¸ì§€ ë¡±í¼</title>
    <link rel="icon" type="image/svg+xml" href="/logo.svg">
    <link rel="stylesheet" href="/css/toss-style.css">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <style>
        /* JSON ì…ë ¥ */
        .json-editor {
            width: 100%;
            min-height: 500px;
            padding: 1rem;
            border: 1px solid var(--color-gray-300);
            border-radius: 8px;
            font-size: 0.85rem;
            font-family: 'Consolas', 'Monaco', monospace;
            line-height: 1.5;
            resize: vertical;
            background: var(--color-bg-tertiary);
            color: var(--color-gray-900);
        }

        .json-editor:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(77, 158, 255, 0.15);
        }

        /* ì„¤ì • */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .setting-item {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
        }

        .setting-item label {
            font-size: 0.8rem;
            color: var(--color-gray-600);
            font-weight: 500;
        }

        .setting-item input,
        .setting-item select {
            padding: 0.6rem 0.75rem;
            border: 1px solid var(--color-gray-300);
            border-radius: 6px;
            font-size: 0.85rem;
            background: var(--color-bg-tertiary);
            color: var(--color-gray-900);
        }

        /* ë²„íŠ¼ */
        .actions {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.15s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-secondary {
            background: var(--color-gray-100);
            color: var(--color-gray-700);
        }

        .btn-secondary:hover {
            background: var(--color-gray-200);
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ë„ì›€ë§ */
        .help-box {
            background: var(--color-gray-50);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .help-box h4 {
            font-size: 0.85rem;
            color: var(--color-gray-800);
            margin-bottom: 0.5rem;
        }

        .help-box pre {
            background: var(--color-bg-tertiary);
            padding: 1rem;
            border-radius: 6px;
            font-size: 0.75rem;
            overflow-x: auto;
            color: var(--color-gray-300);
        }

        .help-box p {
            font-size: 0.8rem;
            color: var(--color-gray-600);
            margin-top: 0.5rem;
        }

        /* ì§„í–‰ ìƒíƒœ */
        .progress-section {
            display: none;
        }

        .progress-section.active {
            display: block;
        }

        .progress-bar-container {
            background: var(--color-gray-200);
            border-radius: 8px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-bar {
            background: var(--color-primary);
            height: 100%;
            width: 0%;
            transition: width 0.3s;
        }

        .progress-status {
            font-size: 0.85rem;
            color: var(--color-gray-600);
            text-align: center;
        }

        .progress-log {
            background: var(--color-bg-tertiary);
            border-radius: 8px;
            padding: 1rem;
            max-height: 150px;
            overflow-y: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.75rem;
            color: var(--color-gray-500);
            margin-top: 1rem;
        }

        .progress-log .log-item {
            padding: 0.25rem 0;
            border-bottom: 1px solid var(--color-gray-200);
        }

        .progress-log .log-item:last-child {
            border-bottom: none;
        }

        .progress-log .success {
            color: var(--color-success);
        }

        .progress-log .error {
            color: var(--color-error);
        }

        /* ê²°ê³¼ */
        .result-section {
            display: none;
        }

        .result-section.active {
            display: block;
        }

        .result-video {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            display: block;
            border-radius: 12px;
            background: #000;
        }

        .result-info {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--color-gray-50);
            border-radius: 8px;
        }

        .result-info p {
            font-size: 0.85rem;
            color: var(--color-gray-600);
            margin: 0.25rem 0;
        }

        .result-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        /* ë¡œë”© */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top-color: currentColor;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* í…œí”Œë¦¿ ë²„íŠ¼ */
        .template-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .template-btn {
            padding: 0.4rem 0.8rem;
            border: 1px solid var(--color-gray-300);
            background: var(--color-bg-elevated);
            border-radius: 6px;
            font-size: 0.75rem;
            color: var(--color-gray-600);
            cursor: pointer;
            transition: all 0.15s;
        }

        .template-btn:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .info-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background: rgba(77, 158, 255, 0.15);
            color: var(--color-primary);
            border-radius: 4px;
            font-size: 0.75rem;
            margin-left: 0.5rem;
        }

        /* Mini Player Styles */
        .mini-player {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 0.5rem;
            padding: 0.5rem 0.75rem;
            background: var(--color-bg-tertiary);
            border-radius: 8px;
            border: 1px solid var(--color-gray-200);
        }

        .mini-player-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 2px solid var(--color-gray-300);
            background: var(--color-bg-secondary);
            color: var(--color-gray-500);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
            padding: 0;
        }

        .mini-player-btn:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
            transform: scale(1.08);
        }

        .mini-player-btn:active {
            transform: scale(0.95);
        }

        .mini-player-btn.playing {
            border-color: var(--color-primary);
            color: var(--color-primary);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);
            }

            50% {
                box-shadow: 0 0 0 6px rgba(59, 130, 246, 0);
            }
        }

        .mini-player-btn svg {
            width: 14px;
            height: 14px;
        }

        .mini-player-info {
            flex: 1;
            min-width: 0;
        }

        .mini-player-progress {
            height: 4px;
            background: var(--color-gray-200);
            border-radius: 2px;
            overflow: hidden;
            cursor: pointer;
        }

        .mini-player-progress-bar {
            height: 100%;
            background: var(--color-primary);
            width: 0%;
            transition: width 0.1s linear;
            border-radius: 2px;
        }

        .mini-player-time {
            font-size: 0.7rem;
            color: var(--color-gray-500);
            margin-top: 0.25rem;
            display: block;
        }

        /* í…Œë§ˆ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .theme-btn {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--color-gray-300);
            background: var(--color-bg-tertiary);
            border-radius: 6px;
            font-size: 0.8rem;
            color: var(--color-gray-600);
            cursor: pointer;
            transition: all 0.15s;
        }

        .theme-btn:hover {
            border-color: var(--color-primary);
            color: var(--color-primary);
        }

        .theme-btn.active {
            border-color: var(--color-primary);
            background: rgba(59, 130, 246, 0.1);
            color: var(--color-primary);
        }

        .example-card {
            padding: 0.75rem;
            border: 1px solid var(--color-gray-200);
            border-radius: 8px;
            background: var(--color-bg-tertiary);
            cursor: pointer;
            transition: all 0.15s;
        }

        .example-card:hover {
            border-color: var(--color-primary);
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);
        }

        .example-card-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-gray-800);
            margin-bottom: 0.25rem;
        }

        .example-card-preview {
            font-size: 0.75rem;
            color: var(--color-gray-500);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .example-card-duration {
            font-size: 0.7rem;
            color: var(--color-primary);
            margin-top: 0.25rem;
        }

        .example-card-duration {
            font-size: 0.7rem;
            color: var(--color-primary);
            margin-top: 0.25rem;
        }

        /* 2ë‹¨ ë ˆì´ì•„ì›ƒ */
        .main-row {
            display: flex;
            gap: 1.5rem;
            width: 100%;
            align-items: flex-start;
        }

        .left-column {
            flex: 1;
            min-width: 0;
            position: sticky;
            top: 2rem;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
        }

        .right-column {
            flex: 1;
            min-width: 0;
        }

        @media (max-width: 900px) {
            .main-row {
                flex-direction: column;
            }

            .left-column {
                position: static;
                width: 100%;
                max-height: none;
            }

            .right-column {
                width: 100%;
                flex: 1;
            }
        }
    </style>
</head>

<body style="visibility: hidden;">
    <!-- Header (injected by header.js) -->
    <div id="header-placeholder"></div>
    <script src="/js/header.js"></script>

    <!-- ì‚¬ìš©ë²• ëª¨ë‹¬ -->
    <div id="guideModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>ğŸ“– ì‚¬ìš©ë²•</h3>
                <button class="modal-close" onclick="closeGuideModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- API í‚¤ ì•ˆë‚´ -->
                <div
                    style="background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; border: 1px solid #ffc107;">
                    <p style="color: #856404; font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem;">âš ï¸ ë¨¼ì € 302.AI
                        API í‚¤ê°€ í•„ìš”í•´ìš”!</p>
                    <p style="color: #856404; font-size: 0.85rem; line-height: 1.6;">
                        í•˜ë‚˜ì˜ <strong>302.AI í‚¤</strong>ë¡œ ì´ë¯¸ì§€ ìƒì„±(DALL-E), ìŒì„± ë“± ëª¨ë“  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ìš”.<br>
                        ì˜¤ë¥¸ìª½ ìœ„ ì„¤ì • ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ API í‚¤ë¥¼ ë¨¼ì € ë“±ë¡í•´ì£¼ì„¸ìš”!
                    </p>
                </div>

                <div
                    style="background: var(--color-bg-tertiary); border-radius: 8px; padding: 1.25rem; margin-bottom: 1rem;">
                    <p style="color: var(--color-gray-700); font-size: 0.9rem; line-height: 1.8;">
                        <strong style="color: var(--color-primary);">AI ë¡±í¼</strong>ì€ ì—¬ëŸ¬ ì¥ë©´ì„ ì—°ê²°í•´ì„œ 5ë¶„ ì´ìƒì˜ ê¸´ ìœ íŠœë¸Œ ì˜ìƒì„
                        ë§Œë“¤ì–´ì¤ë‹ˆë‹¤!<br>
                        ë‹¤íë©˜í„°ë¦¬, ê°•ì˜, ë¦¬ë·° ì˜ìƒ ë“± ë‹¤ì–‘í•œ í˜•ì‹ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.
                    </p>
                    <div
                        style="margin-top: 1rem; padding: 1rem; background: var(--color-bg-secondary); border-radius: 8px; border-left: 3px solid var(--color-primary);">
                        <p
                            style="color: var(--color-gray-800); font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem;">
                            3ë‹¨ê³„ë¡œ ë!</p>
                        <p style="color: var(--color-gray-600); font-size: 0.875rem; line-height: 1.8;">
                            1ï¸âƒ£ ì•„ë˜ ë²„íŠ¼ ëˆŒëŸ¬ì„œ ChatGPTë¡œ ì”¬ êµ¬ì„± ë§Œë“¤ê¸°<br>
                            2ï¸âƒ£ ë§Œë“¤ì–´ì§„ ì”¬ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°<br>
                            3ï¸âƒ£ "ë¡±í¼ ìƒì„±" ë²„íŠ¼ í´ë¦­!
                        </p>
                    </div>
                </div>
                <div style="background: var(--color-bg-tertiary); border-radius: 8px; padding: 1.25rem;">
                    <h4 style="color: var(--color-gray-900); margin-bottom: 0.75rem; font-size: 0.95rem;">ğŸ’¬ AIí•œí…Œ ê¸´ ì˜ìƒ ì”¬
                        ë§Œë“¤ì–´ë‹¬ë¼ê³  í•˜ê¸°</h4>
                    <p style="color: var(--color-gray-500); font-size: 0.8rem; margin-bottom: 0.75rem;">ChatGPT, Claude,
                        Gemini ë“± ì•„ë¬´ AIë‚˜ ì‚¬ìš© ê°€ëŠ¥!</p>

                    <div style="display: grid; gap: 0.75rem; margin-bottom: 1rem;">
                        <div>
                            <label
                                style="font-size: 0.8rem; color: var(--color-gray-600); margin-bottom: 0.25rem; display: block;">ì£¼ì œ</label>
                            <input type="text" id="promptTopic" placeholder="ì˜ˆ: ìš°ì£¼ì˜ ì‹ ë¹„, ë‹¤ì´ì–´íŠ¸ ê¿€íŒ"
                                oninput="updatePromptPreview()"
                                style="width: 100%; padding: 0.5rem; border: 1px solid var(--color-gray-300); border-radius: 6px; font-size: 0.85rem;">
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                            <div>
                                <label
                                    style="font-size: 0.8rem; color: var(--color-gray-600); margin-bottom: 0.25rem; display: block;">ì˜ìƒ
                                    ì¢…ë¥˜</label>
                                <select id="promptType" onchange="updatePromptPreview()"
                                    style="width: 100%; padding: 0.5rem; border: 1px solid var(--color-gray-300); border-radius: 6px; font-size: 0.85rem;">
                                    <option value="ë‹¤íë©˜í„°ë¦¬">ë‹¤íë©˜í„°ë¦¬</option>
                                    <option value="ê°•ì˜/íŠœí† ë¦¬ì–¼">ê°•ì˜/íŠœí† ë¦¬ì–¼</option>
                                    <option value="ë¦¬ë·°">ë¦¬ë·°</option>
                                    <option value="ìŠ¤í† ë¦¬í…”ë§">ìŠ¤í† ë¦¬í…”ë§</option>
                                </select>
                            </div>
                            <div>
                                <label
                                    style="font-size: 0.8rem; color: var(--color-gray-600); margin-bottom: 0.25rem; display: block;">ì˜ìƒ
                                    ê¸¸ì´</label>
                                <select id="promptLength" onchange="updatePromptPreview()"
                                    style="width: 100%; padding: 0.5rem; border: 1px solid var(--color-gray-300); border-radius: 6px; font-size: 0.85rem;">
                                    <option value="5ë¶„">5ë¶„</option>
                                    <option value="10ë¶„">10ë¶„</option>
                                    <option value="15ë¶„">15ë¶„</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <textarea id="promptPreview" readonly
                        style="width: 100%; min-height: 280px; padding: 0.75rem; border: 1px solid var(--color-gray-300); border-radius: 6px; font-size: 0.8rem; font-family: inherit; line-height: 1.6; background: var(--color-bg-secondary); color: var(--color-gray-700); resize: vertical; margin-bottom: 0.75rem;">ê¸´ ìœ íŠœë¸Œ ì˜ìƒ ëŒ€ë³¸ ë§Œë“¤ì–´ì¤˜

ì£¼ì œ: [ì£¼ì œë¥¼ ì…ë ¥í•˜ì„¸ìš”]
ì˜ìƒ ì¢…ë¥˜: ë‹¤íë©˜í„°ë¦¬
ì˜ìƒ ê¸¸ì´: 5ë¶„

ì¡°ê±´:
- ì²˜ìŒì— ê´€ì‹¬ ë„ëŠ” ë„ì…ë¶€
- ì¤‘ê°„ì— í•µì‹¬ ë‚´ìš©
- ë§ˆì§€ë§‰ì— êµ¬ë… ìœ ë„
- ê·¸ë¦¼ ì„¤ëª…ì€ ì˜ì–´ë¡œ

ì´ í˜•ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì¤˜:
[
  {
    "text": "ë„ì…ë¶€ ëŒ€ì‚¬ (2~3ë¬¸ì¥)",
    "imagePrompt": "intro scene, cinematic",
    "duration": 15
  },
  {
    "text": "ë³¸ë¡  ëŒ€ì‚¬ (3~5ë¬¸ì¥)",
    "imagePrompt": "main content scene",
    "duration": 30
  },
  {
    "text": "ë§ˆë¬´ë¦¬ ëŒ€ì‚¬",
    "imagePrompt": "closing scene",
    "duration": 15
  }
]</textarea>

                    <button onclick="copyPromptFromTextarea()"
                        style="width: 100%; background: var(--color-primary); color: white; border: none; padding: 0.75rem 1rem; border-radius: 6px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">ğŸ“‹
                        í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- í˜ì´ì§€ íƒ€ì´í‹€ -->
        <div style="text-align: center; margin-bottom: 2rem;">
            <h1
                style="font-size: 2rem; font-weight: 800; color: var(--color-gray-900); margin-bottom: 0.5rem; letter-spacing: -0.02em;">
                ğŸ¥ AI ì´ë¯¸ì§€ ë¡±í¼ ìƒì„±ê¸°
            </h1>
            <p style="color: var(--color-gray-600); font-size: 1rem;">
                ì—¬ëŸ¬ ì”¬ êµ¬ì„± â†’ AI ì´ë¯¸ì§€ ìƒì„± â†’ AI ìŒì„± í•©ì„± â†’ 5ë¶„+ ê¸´ ì˜ìƒ ì™„ì„±
            </p>
        </div>

        <!-- ë©”ì¸ ë ˆì´ì•„ì›ƒ (ì¢Œìš° ë°°ì¹˜) -->
        <div class="main-row">
            <!-- ì™¼ìª½: ëŒ€ë³¸ ìƒì„±ê¸° -->
            <div class="left-column">
                <!-- ëŒ€ë³¸ ìƒì„±ê¸° -->
                <div class="section">
                    <h2 class="section-title">ğŸ“ ëŒ€ë³¸ ìƒì„±ê¸°</h2>
                    <div id="scriptGenContent">
                        <div style="margin-bottom: 1rem;">
                            <label
                                style="font-size: 0.85rem; color: var(--color-gray-600); margin-bottom: 0.5rem; display: block;">í…Œë§ˆ
                                ì„ íƒ</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;" id="themeButtons">
                                <button type="button" class="theme-btn active" data-theme="documentary"
                                    onclick="selectTheme('documentary')">ğŸ“¹ ë‹¤íë©˜í„°ë¦¬</button>
                                <button type="button" class="theme-btn" data-theme="tutorial"
                                    onclick="selectTheme('tutorial')">ğŸ“š ê°•ì˜/íŠœí† ë¦¬ì–¼</button>
                                <button type="button" class="theme-btn" data-theme="story"
                                    onclick="selectTheme('story')">ğŸ“–
                                    ìŠ¤í† ë¦¬í…”ë§</button>
                                <button type="button" class="theme-btn" data-theme="review"
                                    onclick="selectTheme('review')">â­
                                    ë¦¬ë·°</button>
                                <button type="button" class="theme-btn" data-theme="science"
                                    onclick="selectTheme('science')">ğŸ”¬
                                    ê³¼í•™/ì—­ì‚¬</button>
                                <button type="button" class="theme-btn" data-theme="korea"
                                    onclick="selectTheme('korea')">ğŸ‡°ğŸ‡·
                                    êµ­ë½•</button>
                                <button type="button" class="theme-btn" data-theme="international"
                                    onclick="selectTheme('international')">ğŸ’‘ êµ­ê²°</button>
                            </div>
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <label
                                style="font-size: 0.85rem; color: var(--color-gray-600); margin-bottom: 0.5rem; display: block;">ì˜ˆì‹œ
                                ëŒ€ë³¸ (í´ë¦­í•˜ì—¬ ì ìš©)</label>
                            <div id="exampleScripts" style="display: flex; flex-direction: column; gap: 0.5rem;"></div>
                        </div>
                        <div style="background: var(--color-bg-tertiary); border-radius: 8px; padding: 1rem;">
                            <label
                                style="font-size: 0.85rem; color: var(--color-gray-600); margin-bottom: 0.5rem; display: block;">AIì—ê²Œ
                                ëŒ€ë³¸ ìš”ì²­í•˜ê¸°</label>
                            <input type="text" id="customScriptTopic" placeholder="ì£¼ì œ ì…ë ¥ (ì˜ˆ: ìš°ì£¼ì˜ ì‹ ë¹„, ë‹¤ì´ì–´íŠ¸ ê¿€íŒ)"
                                style="width: 100%; padding: 0.5rem; border: 1px solid var(--color-gray-300); border-radius: 6px; font-size: 0.85rem; margin-bottom: 0.5rem;"
                                oninput="updateScriptPrompt()">
                            <textarea id="scriptPromptPreview" readonly
                                style="width: 100%; min-height: 220px; padding: 0.5rem; border: 1px solid var(--color-gray-300); border-radius: 6px; font-size: 0.8rem; font-family: inherit; background: var(--color-bg-secondary); color: var(--color-gray-600); resize: vertical;"></textarea>
                            <button type="button" onclick="copyScriptPrompt()"
                                style="margin-top: 0.5rem; width: 100%; padding: 0.6rem; background: var(--color-primary); color: white; border: none; border-radius: 6px; font-size: 0.85rem; cursor: pointer; font-weight: 500;">ğŸ“‹
                                í”„ë¡¬í”„íŠ¸ ë³µì‚¬í•˜ê¸°</button>
                        </div>
                    </div>
                </div>
            </div> <!-- left-column ë -->

            <!-- ì˜¤ë¥¸ìª½: ì„¤ì • ë° ìƒì„± -->
            <div class="right-column">



                <!-- ì…ë ¥ ì„¹ì…˜ -->
                <div class="section" id="inputSection">
                    <div class="section-title">
                        ğŸ¬ ë¡±í¼ ì˜ìƒ ì¥ë©´ êµ¬ì„±
                        <span class="info-badge">5ë¶„+ ê¸´ ì˜ìƒ</span>
                    </div>

                    <div class="settings-grid"
                        style="margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--color-gray-200);">
                        <div class="setting-item">
                            <label>ì œëª©</label>
                            <input type="text" id="videoTitle" value="AI_Longform" placeholder="ì˜ìƒ ì œëª©">
                        </div>
                        <div class="setting-item">
                            <label>ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼</label>
                            <select id="imageStyle">
                                <option value="realistic">ì‹¤ì‚¬ (Realistic)</option>
                                <option value="anime">ì• ë‹ˆë©”ì´ì…˜ (Anime)</option>
                                <option value="cartoon">ì¹´íˆ° (Cartoon)</option>
                                <option value="comic">ë¯¸êµ­ ë§Œí™” (Comic)</option>
                                <option value="watercolor">ìˆ˜ì±„í™” (Watercolor)</option>
                                <option value="oil">ìœ í™” (Oil Painting)</option>
                                <option value="3d">3D ë Œë”ë§</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>ë°°ê²½ìŒì•…</label>
                            <select id="bgMusic" onchange="onMusicChange()">
                                <option value="">ì—†ìŒ</option>
                            </select>
                            <!-- Mini Player -->
                            <div id="miniPlayer" class="mini-player" style="display: none;">
                                <button type="button" class="mini-player-btn" onclick="toggleMiniPlayer()"
                                    id="miniPlayerBtn">
                                    <svg id="playIcon" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M8 5v14l11-7z" />
                                    </svg>
                                    <svg id="pauseIcon" viewBox="0 0 24 24" fill="currentColor" style="display:none;">
                                        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                                    </svg>
                                </button>
                                <div class="mini-player-info">
                                    <div class="mini-player-progress">
                                        <div class="mini-player-progress-bar" id="miniPlayerProgress"></div>
                                    </div>
                                    <span class="mini-player-time" id="miniPlayerTime">0:00 / 0:00</span>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <label>í•´ìƒë„</label>
                            <select id="resolution">
                                <option value="1080p">1080p (Full HD)</option>
                                <option value="720p">720p (HD)</option>
                                <option value="4k">4K (Ultra HD)</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>í™”ë©´ ë¹„ìœ¨</label>
                            <select id="aspectRatio">
                                <option value="16:9">16:9 (ìœ íŠœë¸Œ)</option>
                                <option value="9:16">9:16 (ì‡¼ì¸ /ë¦´ìŠ¤)</option>
                                <option value="1:1">1:1 (ì •ì‚¬ê°í˜•)</option>
                            </select>
                        </div>
                    </div>
                    <input type="hidden" id="voiceEmotion" value="neutral">

                    <div class="template-buttons">
                        <button class="template-btn" onclick="loadTemplate('documentary')">ğŸ“¹ ë‹¤íë©˜í„°ë¦¬</button>
                        <button class="template-btn" onclick="loadTemplate('tutorial')">ğŸ“š íŠœí† ë¦¬ì–¼</button>
                        <button class="template-btn" onclick="loadTemplate('story')">ğŸ“– ìŠ¤í† ë¦¬í…”ë§</button>
                        <button class="template-btn" onclick="loadTemplate('review')">â­ ë¦¬ë·°</button>
                    </div>

                    <textarea id="jsonEditor" class="json-editor" placeholder='[
  {
    "text": "ì²« ë²ˆì§¸ ì¥ë©´ ë‚˜ë ˆì´ì…˜ í…ìŠ¤íŠ¸ (ê¸¸ê²Œ ì‘ì„± ê°€ëŠ¥)",
    "imagePrompt": "ì´ë¯¸ì§€ ìƒì„± í”„ë¡¬í”„íŠ¸ (ì˜ì–´ ê¶Œì¥)",
    "duration": 10
  },
  {
    "text": "ë‘ ë²ˆì§¸ ì¥ë©´...",
    "imagePrompt": "second scene description",
    "duration": 15
  }
]'></textarea>

                    <div class="actions">
                        <button class="btn btn-secondary" onclick="validateJson()">êµ¬ì„± ë‚´ìš© í™•ì¸</button>
                        <button class="btn btn-primary" id="generateBtn" onclick="generateLongform()">
                            <span id="generateBtnText">ğŸ¬ ë¡±í¼ ìƒì„±</span>
                            <span class="loading" id="generateLoading" style="display: none;"></span>
                        </button>
                    </div>
                </div>

                <!-- ì§„í–‰ ìƒíƒœ -->
                <div class="section progress-section" id="progressSection">
                    <div class="section-title">â³ ë¡±í¼ ìƒì„± ì§„í–‰ ì¤‘...</div>

                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    <div class="progress-status" id="progressStatus">ì¤€ë¹„ ì¤‘...</div>

                    <div class="progress-log" id="progressLog"></div>
                </div>

                <!-- ê²°ê³¼ -->
                <div class="section result-section" id="resultSection">
                    <div class="section-title">âœ… ë¡±í¼ ìƒì„± ì™„ë£Œ!</div>

                    <video id="resultVideo" class="result-video" controls></video>

                    <div class="result-info" id="resultInfo"></div>

                    <div class="result-actions">
                        <button class="btn btn-secondary" onclick="resetForm()">ìƒˆë¡œ ë§Œë“¤ê¸°</button>
                        <a id="downloadLink" class="btn btn-primary" download>ğŸ“¥ ë‹¤ìš´ë¡œë“œ</a>
                    </div>
                </div>
            </div> <!-- right-column ë -->
        </div> <!-- main-row ë -->
    </div>

    <script>
        // ëŒ€ë³¸ ìƒì„±ê¸° ì˜ˆì‹œ ë°ì´í„° (ë¡±í¼ìš© - duration í¬í•¨)
        const scriptExamples = {
            documentary: [
                {
                    title: "ì¸ë¥˜ ë¬¸ëª…ì˜ ê¸°ì›", totalDuration: "ì•½ 5ë¶„", script: [
                        { text: "ì˜¤ëŠ˜ ìš°ë¦¬ëŠ” ì¸ë¥˜ ì—­ì‚¬ì˜ ì‹œì‘ì ìœ¼ë¡œ ì—¬í–‰ì„ ë– ë‚˜ë´…ë‹ˆë‹¤. ê³¼ì—° ìš°ë¦¬ì˜ ì¡°ìƒë“¤ì€ ì–´ë–»ê²Œ ë¬¸ëª…ì„ ì¼êµ¬ì–´ ëƒˆì„ê¹Œìš”?", imagePrompt: "Ancient human civilization beginnings, cave paintings, early humans, documentary style, cinematic", duration: 12 },
                        { text: "ì•½ 1ë§Œ ë…„ ì „, ì¸ë¥˜ëŠ” ìˆ˜ë µê³¼ ì±„ì§‘ ìƒí™œì—ì„œ ì •ì°© ìƒí™œë¡œ ì „í™˜í•˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ ì‹ ì„ê¸° í˜ëª…ì…ë‹ˆë‹¤.", imagePrompt: "Neolithic revolution, early farming communities, ancient settlements, educational documentary", duration: 15 },
                        { text: "ë©”ì†Œí¬íƒ€ë¯¸ì•„, ì´ì§‘íŠ¸, ì¸ë”ìŠ¤, í™©í•˜ ë¬¸ëª…. ì´ ë„¤ ê°œì˜ ê³ ëŒ€ ë¬¸ëª…ì€ ì¸ë¥˜ ì—­ì‚¬ì˜ ê¸°ë°˜ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.", imagePrompt: "Four ancient civilizations collage, Mesopotamia Egypt Indus China, world map, documentary infographic", duration: 18 },
                        { text: "ê·¸ë“¤ì´ ë‚¨ê¸´ ìœ ì‚°ì€ ì˜¤ëŠ˜ë‚ ê¹Œì§€ ìš°ë¦¬ ì‚¶ì— ì˜í–¥ì„ ë¯¸ì¹˜ê³  ìˆìŠµë‹ˆë‹¤. ë¬¸ì, ë²•ë¥ , ê±´ì¶•, ê·¸ë¦¬ê³  ì² í•™ê¹Œì§€.", imagePrompt: "Legacy of ancient civilizations, writing systems, architecture, philosophy concepts, educational", duration: 15 },
                        { text: "ë‹¤ìŒ ì˜ìƒì—ì„œëŠ” ê° ë¬¸ëª…ì— ëŒ€í•´ ë” ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. êµ¬ë…ê³¼ ì¢‹ì•„ìš” ë¶€íƒë“œë¦½ë‹ˆë‹¤.", imagePrompt: "Subscribe call to action, ancient history theme, documentary ending screen", duration: 10 }
                    ]
                },
                {
                    title: "ì§€êµ¬ì˜ ìˆ¨ê²¨ì§„ ë¹„ë°€", totalDuration: "ì•½ 6ë¶„", script: [
                        { text: "ìš°ë¦¬ê°€ ë§¤ì¼ ë°Ÿê³  ìˆëŠ” ì´ ì§€êµ¬. í•˜ì§€ë§Œ ì§€êµ¬ì˜ ì§„ì •í•œ ëª¨ìŠµì€ ìš°ë¦¬ê°€ ì•Œê³  ìˆëŠ” ê²ƒê³¼ ë§ì´ ë‹¤ë¦…ë‹ˆë‹¤.", imagePrompt: "Earth from space, mysterious glowing atmosphere, cinematic documentary, awe-inspiring", duration: 12 },
                        { text: "ì§€êµ¬ ë‚´ë¶€ì—ëŠ” 6,000ë„ê°€ ë„˜ëŠ” ëœ¨ê±°ìš´ í•µì´ ìˆìŠµë‹ˆë‹¤. íƒœì–‘ í‘œë©´ê³¼ ë¹„ìŠ·í•œ ì˜¨ë„ì˜ˆìš”.", imagePrompt: "Earth cross-section showing hot inner core, geological layers, scientific illustration, dramatic", duration: 15 },
                        { text: "ì´ ëœ¨ê±°ìš´ í•µ ë•ë¶„ì— ì§€êµ¬ëŠ” ìê¸°ì¥ì„ ë§Œë“¤ì–´ë‚´ê³ , ì´ ìê¸°ì¥ì´ ìš°ë¦¬ë¥¼ ìš°ì£¼ ë°©ì‚¬ì„ ìœ¼ë¡œë¶€í„° ë³´í˜¸í•´ì¤ë‹ˆë‹¤.", imagePrompt: "Earth magnetic field visualization, protecting from solar wind, scientific documentary style", duration: 18 },
                        { text: "ë˜í•œ ì§€êµ¬ì˜ ëŒ€ê¸°ëŠ” ì§€êµ¬ ì—­ì‚¬ì—ì„œ ì—¬ëŸ¬ ë²ˆ ì™„ì „íˆ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤. ì²˜ìŒì—ëŠ” ì‚°ì†Œê°€ ê±°ì˜ ì—†ì—ˆì–´ìš”.", imagePrompt: "Earth atmosphere evolution timeline, ancient Earth vs modern, scientific visualization", duration: 15 },
                        { text: "ì´ì²˜ëŸ¼ ì§€êµ¬ëŠ” ê³„ì† ë³€í™”í•˜ê³  ìˆìŠµë‹ˆë‹¤. ìš°ë¦¬ê°€ ì§€êµ¬ë¥¼ ì´í•´í• ìˆ˜ë¡ ë” ì˜ ë³´í˜¸í•  ìˆ˜ ìˆê² ì£ .", imagePrompt: "Beautiful Earth nature montage, forests oceans mountains, conservation message, hopeful", duration: 12 }
                    ]
                }
            ],
            tutorial: [
                {
                    title: "ì´ˆë³´ìë¥¼ ìœ„í•œ íˆ¬ì ì…ë¬¸", totalDuration: "ì•½ 5ë¶„", script: [
                        { text: "ì•ˆë…•í•˜ì„¸ìš”, ì˜¤ëŠ˜ì€ íˆ¬ìë¥¼ ì²˜ìŒ ì‹œì‘í•˜ëŠ” ë¶„ë“¤ì„ ìœ„í•œ ê¸°ë³¸ ê°€ì´ë“œë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.", imagePrompt: "Investment beginners guide, clean modern infographic, money growth concept, educational", duration: 10 },
                        { text: "íˆ¬ìì˜ ì²« ë²ˆì§¸ ì›ì¹™ì€ ë¶„ì‚°íˆ¬ìì…ë‹ˆë‹¤. ê³„ë€ì„ í•œ ë°”êµ¬ë‹ˆì— ë‹´ì§€ ë§ˆë¼ëŠ” ë§ ë“¤ì–´ë³´ì…¨ì£ ?", imagePrompt: "Diversification concept visualization, eggs in multiple baskets, financial education graphic", duration: 15 },
                        { text: "ì£¼ì‹, ì±„ê¶Œ, ë¶€ë™ì‚°, ê¸ˆ. ì´ë ‡ê²Œ ì—¬ëŸ¬ ìì‚°ì— ë‚˜ëˆ ì„œ íˆ¬ìí•˜ë©´ ë¦¬ìŠ¤í¬ë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.", imagePrompt: "Asset classes pie chart, stocks bonds real estate gold, modern financial infographic", duration: 18 },
                        { text: "ë‘ ë²ˆì§¸ ì›ì¹™ì€ ì¥ê¸°íˆ¬ìì…ë‹ˆë‹¤. ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ë³µë¦¬ì˜ íš¨ê³¼ê°€ ì—„ì²­ë‚˜ê²Œ ì»¤ì§€ê±°ë“ ìš”.", imagePrompt: "Compound interest growth chart over time, exponential curve, financial education", duration: 15 },
                        { text: "ë§ˆì§€ë§‰ìœ¼ë¡œ, ì ˆëŒ€ ë¹šì„ ë‚´ì„œ íˆ¬ìí•˜ì§€ ë§ˆì„¸ìš”. ì´ê²ƒë§Œ ì§€ì¼œë„ í° ì‹¤íŒ¨ë¥¼ í”¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.", imagePrompt: "Warning about debt investing, red flags financial advice, cautionary educational", duration: 12 }
                    ]
                },
                {
                    title: "ìƒì‚°ì„± 10ë°° ë†’ì´ëŠ” ë²•", totalDuration: "ì•½ 4ë¶„", script: [
                        { text: "í•˜ë£¨ê°€ 24ì‹œê°„ì¸ ê±´ ëª¨ë‘ì—ê²Œ ë˜‘ê°™ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì–´ë–¤ ì‚¬ëŒì€ 24ì‹œê°„ ì•ˆì— ë†€ë¼ìš´ ì„±ê³¼ë¥¼ ë§Œë“¤ì–´ë‚´ì£ .", imagePrompt: "Productivity concept, time management visualization, successful person working efficiently", duration: 10 },
                        { text: "ì²« ë²ˆì§¸ ë¹„ë°€ì€ ê°€ì¥ ì¤‘ìš”í•œ ì¼ì„ ì•„ì¹¨ì— í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ ë‡ŒëŠ” ì•„ì¹¨ì— ê°€ì¥ ë§‘ê±°ë“ ìš”.", imagePrompt: "Morning productivity routine, person working early, sunrise, fresh start concept", duration: 15 },
                        { text: "ë‘ ë²ˆì§¸ëŠ” ë©€í‹°íƒœìŠ¤í‚¹ì„ ë²„ë¦¬ëŠ” ê²ƒì…ë‹ˆë‹¤. í•œ ë²ˆì— í•˜ë‚˜ì˜ ì¼ì—ë§Œ ì§‘ì¤‘í•˜ì„¸ìš”.", imagePrompt: "Single tasking vs multitasking comparison, focus concept, productivity infographic", duration: 15 },
                        { text: "ì„¸ ë²ˆì§¸, í¬ëª¨ë„ë¡œ ê¸°ë²•ì„ í™œìš©í•˜ì„¸ìš”. 25ë¶„ ì§‘ì¤‘, 5ë¶„ íœ´ì‹. ì´ ë¦¬ë“¬ì´ ë†€ë¼ìš´ íš¨ê³¼ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.", imagePrompt: "Pomodoro technique timer, 25 min work 5 min break cycle, productivity method", duration: 15 },
                        { text: "ì˜¤ëŠ˜ë¶€í„° ë°”ë¡œ ì‹œì‘í•´ë³´ì„¸ìš”. ì—¬ëŸ¬ë¶„ì˜ ìƒì‚°ì„±ì´ ì™„ì „íˆ ë‹¬ë¼ì§ˆ ê±°ì˜ˆìš”!", imagePrompt: "Motivated person achieving goals, success celebration, call to action ending", duration: 10 }
                    ]
                }
            ],
            story: [
                {
                    title: "ì‹¤íŒ¨í•œ ì‚¬ì—…ê°€ì˜ ì¬ê¸°", totalDuration: "ì•½ 5ë¶„", script: [
                        { text: "ê·¸ëŠ” ëª¨ë“  ê²ƒì„ ìƒì—ˆìŠµë‹ˆë‹¤. ì‚¬ì—… ì‹¤íŒ¨ë¡œ ë¹šë§Œ 10ì–µ. ê°€ì¡±ë„ ë– ë‚¬ê³ , ì¹œêµ¬ë„ ì—†ì—ˆìŠµë‹ˆë‹¤.", imagePrompt: "Businessman at rock bottom, losing everything, dark emotional scene, cinematic storytelling", duration: 12 },
                        { text: "í•˜ì§€ë§Œ ê·¸ëŠ” í¬ê¸°í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë§¤ì¼ ì•„ì¹¨ 5ì‹œì— ì¼ì–´ë‚˜ ìƒˆë¡œìš´ ì‚¬ì—… ì•„ì´ë””ì–´ë¥¼ ì—°êµ¬í–ˆìŠµë‹ˆë‹¤.", imagePrompt: "Man working hard early morning, determination, studying business, comeback story", duration: 15 },
                        { text: "3ë…„ í›„, ê·¸ëŠ” ì‘ì€ ì˜¨ë¼ì¸ ì‡¼í•‘ëª°ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ì²˜ìŒì—” í•˜ë£¨ ë§¤ì¶œì´ 1ë§Œ ì›ë„ ì•ˆ ëì–´ìš”.", imagePrompt: "Small online business beginning, humble start, laptop showing small sales, realistic", duration: 15 },
                        { text: "í•˜ì§€ë§Œ 5ë…„ì´ ì§€ë‚œ ì§€ê¸ˆ, ê·¸ì˜ íšŒì‚¬ëŠ” ì—°ë§¤ì¶œ 500ì–µ ì›ì„ ê¸°ë¡í•˜ê³  ìˆìŠµë‹ˆë‹¤.", imagePrompt: "Successful businessman, company growth, from small to big business, success story climax", duration: 12 },
                        { text: "ê·¸ê°€ ë§í•©ë‹ˆë‹¤. ì‹¤íŒ¨ëŠ” ëì´ ì•„ë‹ˆë¼ ì‹œì‘ì…ë‹ˆë‹¤. í¬ê¸°í•˜ì§€ ì•Šìœ¼ë©´ ê¸°íšŒëŠ” ë°˜ë“œì‹œ ì˜µë‹ˆë‹¤.", imagePrompt: "Inspirational quote scene, successful man looking at horizon, motivational ending", duration: 12 }
                    ]
                }
            ],
            review: [
                {
                    title: "ì•„ì´í° vs ê°¤ëŸ­ì‹œ ì†”ì§ ë¹„êµ", totalDuration: "ì•½ 6ë¶„", script: [
                        { text: "ì•ˆë…•í•˜ì„¸ìš”, ì˜¤ëŠ˜ì€ ë§ì€ ë¶„ë“¤ì´ ê¶ê¸ˆí•´í•˜ì‹œëŠ” ì•„ì´í°ê³¼ ê°¤ëŸ­ì‹œ ë¹„êµ ë¦¬ë·°ë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.", imagePrompt: "iPhone vs Galaxy comparison, professional product review setup, tech review style", duration: 10 },
                        { text: "ë¨¼ì € ë””ìì¸ë¶€í„° ë¹„êµí•´ë³¼ê²Œìš”. ë‘ ì œí’ˆ ëª¨ë‘ í”„ë¦¬ë¯¸ì—„ ëŠë‚Œì´ì§€ë§Œ í™•ì‹¤íˆ ë‹¤ë¥¸ ê°œì„±ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.", imagePrompt: "Side by side phone design comparison, premium smartphones, detail shots, review style", duration: 15 },
                        { text: "ì¹´ë©”ë¼ ì„±ëŠ¥ì€ ì–´ë–¨ê¹Œìš”? ë‚®ì—ëŠ” ë¹„ìŠ·í•˜ì§€ë§Œ, ì•¼ê°„ ì´¬ì˜ì—ì„œ í¥ë¯¸ë¡œìš´ ì°¨ì´ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.", imagePrompt: "Camera comparison test photos, day and night shots, smartphone photography review", duration: 18 },
                        { text: "ë°°í„°ë¦¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼ì…ë‹ˆë‹¤. ë™ì˜ìƒ ì¬ìƒ ê¸°ì¤€ìœ¼ë¡œ ê°¤ëŸ­ì‹œê°€ 2ì‹œê°„ ë” ì˜¤ë˜ ê°”ì–´ìš”.", imagePrompt: "Battery life test comparison chart, smartphone endurance test, tech review infographic", duration: 15 },
                        { text: "ì†Œí”„íŠ¸ì›¨ì–´ ê²½í—˜ì€ ê°œì¸ ì·¨í–¥ì…ë‹ˆë‹¤. iOSëŠ” ë‹¨ìˆœí•¨, ì•ˆë“œë¡œì´ë“œëŠ” ììœ ë¡œì›€ì´ ê°•ì ì´ì£ .", imagePrompt: "iOS vs Android user interface comparison, software experience, tech review style", duration: 15 },
                        { text: "ê²°ë¡ ì ìœ¼ë¡œ, ì •ë‹µì€ ì—†ìŠµë‹ˆë‹¤. ì—¬ëŸ¬ë¶„ì˜ ì‚¬ìš© íŒ¨í„´ì— ë§ëŠ” í°ì„ ì„ íƒí•˜ì„¸ìš”.", imagePrompt: "Final verdict comparison summary, balanced review conclusion, tech recommendation", duration: 10 }
                    ]
                }
            ],
            science: [
                {
                    title: "ë¸”ë™í™€ì˜ ë¹„ë°€", totalDuration: "ì•½ 5ë¶„", script: [
                        { text: "ë¸”ë™í™€. ë¹›ì¡°ì°¨ íƒˆì¶œí•  ìˆ˜ ì—†ëŠ” ìš°ì£¼ì˜ ê´´ë¬¼. ì˜¤ëŠ˜ ê·¸ ë¹„ë°€ì„ íŒŒí—¤ì³ ë³´ê² ìŠµë‹ˆë‹¤.", imagePrompt: "Massive black hole in space, event horizon glowing, scientific visualization, dramatic cosmos", duration: 12 },
                        { text: "ë¸”ë™í™€ì€ ì§ˆëŸ‰ì´ ë§¤ìš° í° ë³„ì´ ì£½ì„ ë•Œ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. ì¤‘ë ¥ì´ ë„ˆë¬´ ê°•í•´ì„œ ëª¨ë“  ê²ƒì„ ë¹¨ì•„ë“¤ì´ì£ .", imagePrompt: "Star collapsing into black hole formation, supernova to black hole, scientific animation style", duration: 15 },
                        { text: "ë¸”ë™í™€ ê·¼ì²˜ì—ì„œëŠ” ì‹œê°„ì´ ëŠë¦¬ê²Œ íë¦…ë‹ˆë‹¤. ì˜í™” ì¸í„°ìŠ¤í…”ë¼ì—ì„œ ë³¸ ê²ƒì²˜ëŸ¼ìš”.", imagePrompt: "Time dilation near black hole visualization, relativity effect, Interstellar movie reference", duration: 15 },
                        { text: "2019ë…„ ì¸ë¥˜ëŠ” ì²˜ìŒìœ¼ë¡œ ë¸”ë™í™€ì˜ ì‚¬ì§„ì„ ì°ëŠ” ë° ì„±ê³µí–ˆìŠµë‹ˆë‹¤. ì—­ì‚¬ì ì¸ ìˆœê°„ì´ì—ˆì£ .", imagePrompt: "First black hole photograph M87, Event Horizon Telescope achievement, historic scientific moment", duration: 15 },
                        { text: "ë¸”ë™í™€ì€ ì—¬ì „íˆ ë§ì€ ë¹„ë°€ì„ ê°„ì§í•˜ê³  ìˆìŠµë‹ˆë‹¤. ìš°ì£¼ íƒí—˜ì€ ê³„ì†ë©ë‹ˆë‹¤.", imagePrompt: "Future space exploration concept, mysteries of universe, hopeful scientific ending", duration: 12 }
                    ]
                },
                {
                    title: "ê³µë£¡ ë©¸ì¢…ì˜ ì§„ì‹¤", totalDuration: "ì•½ 5ë¶„", script: [
                        { text: "6600ë§Œ ë…„ ì „, ì§€êµ¬ë¥¼ ì§€ë°°í•˜ë˜ ê³µë£¡ì´ ê°‘ìê¸° ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤. ëŒ€ì²´ ë¬´ìŠ¨ ì¼ì´ ìˆì—ˆë˜ ê±¸ê¹Œìš”?", imagePrompt: "Dinosaurs roaming ancient Earth, before extinction, prehistoric landscape, documentary style", duration: 12 },
                        { text: "ê³¼í•™ìë“¤ì€ ê±°ëŒ€í•œ ì†Œí–‰ì„±ì´ ì§€êµ¬ì™€ ì¶©ëŒí–ˆë‹¤ê³  ë¯¿ê³  ìˆìŠµë‹ˆë‹¤. ë©•ì‹œì½” ìœ ì¹´íƒ„ ë°˜ë„ì— ê·¸ ì¦ê±°ê°€ ìˆì–´ìš”.", imagePrompt: "Asteroid impact on Earth, Chicxulub crater formation, extinction event, dramatic scientific", duration: 15 },
                        { text: "ì¶©ëŒë¡œ ì¸í•œ ë¨¼ì§€ì™€ ì¬ê°€ í•˜ëŠ˜ì„ ë’¤ë®ì—ˆìŠµë‹ˆë‹¤. ëª‡ ë…„ ë™ì•ˆ í–‡ë¹›ì´ ì°¨ë‹¨ë˜ì—ˆì£ .", imagePrompt: "Dark sky after asteroid impact, dust clouds blocking sun, apocalyptic Earth scene", duration: 15 },
                        { text: "ì‹ë¬¼ì´ ì£½ê³ , ì´ˆì‹ ê³µë£¡ì´ ì£½ê³ , ìœ¡ì‹ ê³µë£¡ë„ ë¨¹ì´ê°€ ì—†ì–´ ì£½ì—ˆìŠµë‹ˆë‹¤. ì—°ì‡„ ë©¸ì¢…ì´ì—ˆì–´ìš”.", imagePrompt: "Food chain collapse, dinosaurs dying, ecological disaster, extinction documentary", duration: 15 },
                        { text: "í•˜ì§€ë§Œ ê³µë£¡ì˜ í›„ì†ì€ ì‚´ì•„ë‚¨ì•˜ìŠµë‹ˆë‹¤. ë°”ë¡œ ìƒˆì…ë‹ˆë‹¤. í•˜ëŠ˜ì„ ë‚˜ëŠ” ê³µë£¡ì´ ì§€ê¸ˆë„ ìš°ë¦¬ ê³ì— ìˆì–´ìš”.", imagePrompt: "Birds as dinosaur descendants, evolution connection, modern birds and dinosaur comparison", duration: 12 }
                    ]
                }
            ],
            korea: [
                {
                    title: "í•œêµ­ì´ ì„¸ê³„ë¥¼ ë†€ë¼ê²Œ í•œ ìˆœê°„ë“¤", totalDuration: "ì•½ 6ë¶„", script: [
                        { text: "ëŒ€í•œë¯¼êµ­. ì‘ì€ ë‚˜ë¼ê°€ ì–´ë–»ê²Œ ì„¸ê³„ë¥¼ ë†€ë¼ê²Œ í–ˆì„ê¹Œìš”? ì˜¤ëŠ˜ ê·¸ ì´ì•¼ê¸°ë¥¼ í•´ë“œë¦´ê²Œìš”.", imagePrompt: "South Korea on world map, glowing and prominent, Korean flag waving, dramatic documentary opening", duration: 12 },
                        { text: "1950ë…„, í•œêµ­ì „ìŸ ì§í›„ í•œêµ­ì€ ì„¸ê³„ì—ì„œ ê°€ì¥ ê°€ë‚œí•œ ë‚˜ë¼ ì¤‘ í•˜ë‚˜ì˜€ìŠµë‹ˆë‹¤.", imagePrompt: "Post-war Korea 1950s, destroyed buildings, poverty, black and white documentary style", duration: 15 },
                        { text: "í•˜ì§€ë§Œ ë¶ˆê³¼ 70ë…„ ë§Œì— ì„¸ê³„ 10ìœ„ ê²½ì œ ëŒ€êµ­ì´ ë˜ì—ˆì–´ìš”. í•œê°•ì˜ ê¸°ì ì´ë¼ê³  ë¶ˆë¦½ë‹ˆë‹¤.", imagePrompt: "Modern Seoul skyline, Han River, dramatic transformation, before and after comparison", duration: 18 },
                        { text: "ì‚¼ì„±, í˜„ëŒ€, LG. í•œêµ­ ê¸°ì—…ë“¤ì´ ì„¸ê³„ ì‹œì¥ì„ ì¥ì•…í•˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤.", imagePrompt: "Korean conglomerates logos, Samsung Hyundai LG, global business empire, corporate documentary", duration: 15 },
                        { text: "K-pop, K-ë“œë¼ë§ˆ, K-ë·°í‹°. ì´ì œëŠ” ë¬¸í™”ê¹Œì§€ ì„¸ê³„ë¥¼ ì‚¬ë¡œì¡ê³  ìˆì–´ìš”.", imagePrompt: "K-pop concert, Korean drama scene, K-beauty products, cultural wave, Korean Wave documentary", duration: 15 },
                        { text: "ëŒ€í•œë¯¼êµ­ êµ­ë¯¼ìœ¼ë¡œ íƒœì–´ë‚œ ê²ƒ, ì •ë§ ìë‘ìŠ¤ëŸ½ì§€ ì•Šìœ¼ì„¸ìš”?", imagePrompt: "Proud Korean citizens, Korean flag sunset, patriotic moment, emotional documentary ending", duration: 12 }
                    ]
                },
                {
                    title: "ì™¸êµ­ì¸ë“¤ì´ í•œêµ­ì—ì„œ ì¶©ê²©ë°›ì€ ê²ƒë“¤", totalDuration: "ì•½ 5ë¶„", script: [
                        { text: "ì™¸êµ­ì¸ë“¤ì´ í•œêµ­ì— ì˜¤ë©´ ì¶©ê²©ë°›ëŠ” ê²ƒë“¤ì´ ìˆëŒ€ìš”. ë­”ì§€ ê¶ê¸ˆí•˜ì‹œì£ ?", imagePrompt: "Foreigners amazed in Seoul, surprised tourists, Korean street scene, documentary intro", duration: 10 },
                        { text: "ì²«ì§¸, ë°°ë‹¬ ë¬¸í™”. ì‚°ê¼­ëŒ€ê¸°ì—ë„ ì¹˜í‚¨ì´ ë°°ë‹¬ë¼ìš”. 30ë¶„ ë§Œì—ìš”.", imagePrompt: "Korean food delivery to mountain top, delivery scooter, amazing Korean service culture", duration: 15 },
                        { text: "ë‘˜ì§¸, ì¸í„°ë„· ì†ë„. í•œêµ­ì€ ì„¸ê³„ 1ìœ„ì˜ˆìš”. ì§€í•˜ì² ì—ì„œë„ ëŠê¹€ì´ ì—†ì–´ìš”.", imagePrompt: "Superfast internet speed test, 5G network, Seoul subway with everyone on phones", duration: 15 },
                        { text: "ì…‹ì§¸, ì˜ë£Œ ì‹œìŠ¤í…œ. ë‹¹ì¼ ì§„ë£Œê°€ ê°€ëŠ¥í•´ìš”. ë¯¸êµ­ì€ 3ê°œì›” ê¸°ë‹¤ë ¤ì•¼ í•´ìš”.", imagePrompt: "Korean hospital efficiency, same-day medical care, healthcare system comparison", duration: 15 },
                        { text: "ë„·ì§¸, ì¹˜ì•ˆ. ìƒˆë²½ì— í˜¼ì ë‹¤ë…€ë„ ì•ˆì „í•´ìš”. ì„¸ê³„ì—ì„œ ê°€ì¥ ì•ˆì „í•œ ë‚˜ë¼ ì¤‘ í•˜ë‚˜ì˜ˆìš”.", imagePrompt: "Safe Korean streets at night, peaceful night walking, security cameras, safe society", duration: 15 },
                        { text: "í•œêµ­ì¸ìœ¼ë¡œ íƒœì–´ë‚œ ê±°, ì§„ì§œ ë³µì´ì—ìš”!", imagePrompt: "Proud to be Korean, beautiful Korea montage, flag waving, patriotic ending", duration: 10 }
                    ]
                }
            ],
            international: [
                {
                    title: "êµ­ì œì»¤í”Œì˜ í˜„ì‹¤ì ì¸ ì´ì•¼ê¸°", totalDuration: "ì•½ 6ë¶„", script: [
                        { text: "êµ­ì œì»¤í”Œ, ë¡œë§¨í‹±í•´ ë³´ì´ì£ ? í•˜ì§€ë§Œ í˜„ì‹¤ì€ ì¢€ ë‹¤ë¦…ë‹ˆë‹¤. ì˜¤ëŠ˜ ì†”ì§í•˜ê²Œ ë§ì”€ë“œë¦´ê²Œìš”.", imagePrompt: "International couple, Korean with foreign partner, realistic documentary style, honest story", duration: 12 },
                        { text: "ì–¸ì–´ ì¥ë²½ì´ ê°€ì¥ ë¨¼ì € ì°¾ì•„ì™€ìš”. ë¯¸ë¬˜í•œ ê°ì •ì„ ì „ë‹¬í•˜ê¸°ê°€ ì–´ë ¤ì›Œìš”.", imagePrompt: "Couple trying to communicate, language barrier visualization, translation app, struggling but trying", duration: 15 },
                        { text: "ë¬¸í™” ì°¨ì´ë„ ë§Œë§Œì¹˜ ì•Šì•„ìš”. ëª…ì ˆì— ì–´ë””ë¡œ ê°ˆì§€, ì•„ì´ êµìœ¡ì€ ì–´ë–»ê²Œ í• ì§€.", imagePrompt: "Cultural differences discussion, holiday plans, family traditions, educational choices", duration: 18 },
                        { text: "í•˜ì§€ë§Œ ì¥ì ë„ ë§ì•„ìš”. ë‘ ë¬¸í™”ë¥¼ ê²½í—˜í•  ìˆ˜ ìˆê³ , ì•„ì´ê°€ ì´ì¤‘ì–¸ì–´ë¥¼ í•  ìˆ˜ ìˆì–´ìš”.", imagePrompt: "Benefits of international marriage, bilingual children, cultural exchange, positive aspects", duration: 15 },
                        { text: "ë¬´ì—‡ë³´ë‹¤ ì„œë¡œ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë” ëŒ€í™”ë¥¼ ë§ì´ í•˜ê²Œ ë¼ìš”. ê·¸ê²Œ ë¹„ê²°ì´ì—ìš”.", imagePrompt: "Couple having deep conversation, communication is key, understanding each other, love story", duration: 15 },
                        { text: "ì‚¬ë‘ì— êµ­ê²½ì€ ì—†ìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ê±´ ì„œë¡œë¥¼ ì´í•´í•˜ë ¤ëŠ” ë§ˆìŒì´ì—ìš”.", imagePrompt: "International couple holding hands, love without borders, world map heart shape, romantic ending", duration: 12 }
                    ]
                },
                {
                    title: "ì™¸êµ­ì¸ ë°°ìš°ìê°€ ë§í•˜ëŠ” í•œêµ­ ìƒí™œ", totalDuration: "ì•½ 5ë¶„", script: [
                        { text: "ì™¸êµ­ì¸ ë°°ìš°ìê°€ í•œêµ­ì— ì‚´ë©´ì„œ ëŠë‚€ ì ì„ ê³µìœ í•´ë“œë¦´ê²Œìš”.", imagePrompt: "Foreign spouse living in Korea, daily life, Korean apartment, documentary interview style", duration: 10 },
                        { text: "ì²˜ìŒì—” ëª¨ë“  ê²Œ ë‚¯ì„¤ì—ˆëŒ€ìš”. ì–¸ì–´ë„, ìŒì‹ë„, ë¬¸í™”ë„.", imagePrompt: "Foreigner adjusting to Korean life, new experiences, learning Korean, trying Korean food", duration: 15 },
                        { text: "í•˜ì§€ë§Œ ì‹œê°„ì´ ì§€ë‚˜ë‹ˆê¹Œ í•œêµ­ì˜ ì¢‹ì€ ì ì´ ë³´ì´ê¸° ì‹œì‘í–ˆëŒ€ìš”.", imagePrompt: "Discovering good things about Korea, convenience stores, public transport, kind people", duration: 15 },
                        { text: "íŠ¹íˆ ì•ˆì „í•¨ê³¼ í¸ë¦¬í•¨. ìƒˆë²½ì— í¸ì˜ì  ê°€ë„ ë¬´ì„­ì§€ ì•ŠëŒ€ìš”.", imagePrompt: "Safe Korean neighborhood at night, 24-hour convenience store, peaceful living", duration: 15 },
                        { text: "ì§€ê¸ˆì€ í•œêµ­ì´ ì œ2ì˜ ê³ í–¥ì´ ëëŒ€ìš”. í•œêµ­ ì‚¬ëŠ” ê²Œ í–‰ë³µí•˜ëŒ€ìš”.", imagePrompt: "Happy life in Korea, feeling at home, Korean family life, heartwarming ending", duration: 12 }
                    ]
                }
            ]
        };
        let currentScriptTheme = 'documentary';

        // ëŒ€ë³¸ ìƒì„±ê¸° í† ê¸€ (í•­ìƒ í¼ì¹¨)
        /*
        document.getElementById('scriptGenToggle').addEventListener('click', () => {
            const content = document.getElementById('scriptGenContent');
            const icon = document.getElementById('scriptGenToggleIcon');
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.textContent = 'â–² ì ‘ê¸°';
                updateExampleScripts();
                updateScriptPrompt();
            } else {
                content.style.display = 'none';
                icon.textContent = 'â–¼ í¼ì¹˜ê¸°';
            }
        });
        */

        function selectTheme(theme) {
            currentScriptTheme = theme;
            document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.theme-btn[data-theme="${theme}"]`).classList.add('active');
            updateExampleScripts();
            updateScriptPrompt();
        }

        function updateExampleScripts() {
            const container = document.getElementById('exampleScripts');
            const examples = scriptExamples[currentScriptTheme] || [];
            container.innerHTML = examples.map((ex, i) => `
                <div class="example-card" onclick="applyScriptExample(${i})">
                    <div class="example-card-title">${ex.title}</div>
                    <div class="example-card-preview">${ex.script[0].text}</div>
                    <div class="example-card-duration">â±ï¸ ${ex.totalDuration} (${ex.script.length}ê°œ ì”¬)</div>
                </div>
            `).join('');
        }

        function applyScriptExample(index) {
            const example = scriptExamples[currentScriptTheme][index];
            document.getElementById('jsonEditor').value = JSON.stringify(example.script, null, 2);
            alert('ëŒ€ë³¸ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function updateScriptPrompt() {
            const topic = document.getElementById('customScriptTopic').value || getDefaultScriptTopic();
            const prompt = `ê¸´ ìœ íŠœë¸Œ ì˜ìƒ ëŒ€ë³¸ ë§Œë“¤ì–´ì¤˜ (5ë¶„ ì´ìƒ)

ì£¼ì œ: ${topic}

ì¡°ê±´:
- 8~12ê°œ ì¥ë©´ìœ¼ë¡œ êµ¬ì„±
- ê° ì¥ë©´ë§ˆë‹¤ ì½ì„ ëŒ€ì‚¬ ì‘ì„± (ìì—°ìŠ¤ëŸ¬ìš´ ë§íˆ¬)
- ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸ëŠ” ì˜ì–´ë¡œ ìƒì„¸í•˜ê²Œ
- durationì€ ëŒ€ì‚¬ ê¸¸ì´ì— ë§ê²Œ 10~30ì´ˆ ì‚¬ì´ë¡œ ì„¤ì •
- ë„ì…ë¶€ â†’ ë³¸ë¡  â†’ ê²°ë¡  êµ¬ì¡°ë¡œ

ì´ JSON í˜•ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì¤˜:
[
  {
    "text": "ë„ì…ë¶€ ëŒ€ì‚¬ (í¥ë¯¸ ìœ ë°œ)",
    "imagePrompt": "engaging intro scene, cinematic, high quality",
    "duration": 12
  },
  {
    "text": "ë³¸ë¡  ëŒ€ì‚¬ (í•µì‹¬ ë‚´ìš©)",
    "imagePrompt": "main content scene description",
    "duration": 20
  },
  {
    "text": "ë§ˆë¬´ë¦¬ ëŒ€ì‚¬ (êµ¬ë… ìœ ë„)",
    "imagePrompt": "closing scene, call to action",
    "duration": 10
  }
]`;
            document.getElementById('scriptPromptPreview').value = prompt;
        }

        function getDefaultScriptTopic() {
            const topics = { documentary: 'ì¸ë¥˜ ë¬¸ëª…ì˜ ê¸°ì›', tutorial: 'ì´ˆë³´ìë¥¼ ìœ„í•œ íˆ¬ì ê°€ì´ë“œ', story: 'ì„±ê³µí•œ ì‚¬ëŒë“¤ì˜ ì´ì•¼ê¸°', review: 'ìµœì‹  ìŠ¤ë§ˆíŠ¸í° ë¹„êµ', science: 'ìš°ì£¼ì˜ ì‹ ë¹„', korea: 'í•œêµ­ì´ ì„¸ê³„ë¥¼ ë†€ë¼ê²Œ í•œ ìˆœê°„ë“¤', international: 'êµ­ì œì»¤í”Œì˜ í˜„ì‹¤ì ì¸ ì´ì•¼ê¸°' };
            return topics[currentScriptTheme] || 'ì£¼ì œë¥¼ ì…ë ¥í•˜ì„¸ìš”';
        }

        function copyScriptPrompt() {
            const prompt = document.getElementById('scriptPromptPreview').value;
            navigator.clipboard.writeText(prompt).then(() => alert('í”„ë¡¬í”„íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! AIì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”'));
        }

        // Templates
        const templates = {
            documentary: [
                {
                    text: "ì˜¤ëŠ˜ ìš°ë¦¬ê°€ ì‚´í´ë³¼ ì£¼ì œëŠ” ì¸ë¥˜ ì—­ì‚¬ìƒ ê°€ì¥ ìœ„ëŒ€í•œ ë°œëª…í’ˆ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.",
                    imagePrompt: "Epic cinematic shot of human innovation through history, dramatic lighting, documentary style",
                    duration: 8
                },
                {
                    text: "ê³ ëŒ€ë¶€í„° í˜„ëŒ€ê¹Œì§€, ì¸ë¥˜ëŠ” ëŠì„ì—†ì´ ë°œì „í•´ì™”ìŠµë‹ˆë‹¤. ê·¸ ê³¼ì •ì—ì„œ ìˆ˜ë§ì€ ë„ì „ê³¼ ì‹¤íŒ¨ê°€ ìˆì—ˆì§€ë§Œ, ìš°ë¦¬ëŠ” í¬ê¸°í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.",
                    imagePrompt: "Timeline montage showing human evolution and technological progress, from ancient to modern, documentary photography",
                    duration: 12
                },
                {
                    text: "ì´ ì—¬ì •ì˜ ì‹œì‘ì ìœ¼ë¡œ ëŒì•„ê°€ë³´ê² ìŠµë‹ˆë‹¤. ëª¨ë“  ìœ„ëŒ€í•œ ë°œëª…ì€ ì‘ì€ ì•„ì´ë””ì–´ì—ì„œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.",
                    imagePrompt: "A lightbulb moment, creative spark visualization, warm inspiring lighting, documentary style",
                    duration: 10
                },
                {
                    text: "ë‹¤ìŒ ì˜ìƒì—ì„œëŠ” ë” ê¹Šì´ ìˆëŠ” ë‚´ìš©ì„ ë‹¤ë£¨ê² ìŠµë‹ˆë‹¤. êµ¬ë…ê³¼ ì¢‹ì•„ìš” ë¶€íƒë“œë¦½ë‹ˆë‹¤.",
                    imagePrompt: "Modern subscribe button animation, call to action, clean professional style",
                    duration: 8
                }
            ],
            tutorial: [
                {
                    text: "ì•ˆë…•í•˜ì„¸ìš”, ì˜¤ëŠ˜ì€ ì´ˆë³´ìë„ ì‰½ê²Œ ë”°ë¼í•  ìˆ˜ ìˆëŠ” íŠœí† ë¦¬ì–¼ì„ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤.",
                    imagePrompt: "Clean modern tutorial intro screen, welcoming atmosphere, professional educational style",
                    duration: 6
                },
                {
                    text: "ë¨¼ì € ê¸°ë³¸ ê°œë…ë¶€í„° ì°¨ê·¼ì°¨ê·¼ ì„¤ëª…í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì´ ë¶€ë¶„ì„ ì´í•´í•˜ë©´ ë‚˜ë¨¸ì§€ëŠ” í›¨ì”¬ ì‰¬ì›Œì§‘ë‹ˆë‹¤.",
                    imagePrompt: "Step by step visual guide, numbered instructions, clean infographic style",
                    duration: 12
                },
                {
                    text: "ì´ì œ ì‹¤ì œë¡œ ì ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤. í™”ë©´ì„ ì˜ ë³´ì‹œê³  ë”°ë¼í•´ì£¼ì„¸ìš”.",
                    imagePrompt: "Hands-on demonstration, practical application, tutorial screen recording style",
                    duration: 15
                },
                {
                    text: "ì¶•í•˜í•©ë‹ˆë‹¤! ì´ì œ ê¸°ë³¸ì„ ë§ˆìŠ¤í„°í•˜ì…¨ìŠµë‹ˆë‹¤. ë” ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹œë©´ ëŒ“ê¸€ë¡œ ë‚¨ê²¨ì£¼ì„¸ìš”.",
                    imagePrompt: "Celebration, achievement unlocked, congratulatory graphics, positive energy",
                    duration: 8
                }
            ],
            story: [
                {
                    text: "ì´ê²ƒì€ ì•„ë¬´ë„ ë¯¿ì§€ ì•Šì•˜ë˜ í•œ ì‚¬ëŒì˜ ì´ì•¼ê¸°ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ì˜ ê²°ì‹¬ì€ ì„¸ìƒì„ ë°”ê¾¸ê²Œ ë©ë‹ˆë‹¤.",
                    imagePrompt: "Silhouette of a determined person against dramatic sunset, cinematic storytelling",
                    duration: 10
                },
                {
                    text: "ëª¨ë“  ê²ƒì´ ë¶ˆê°€ëŠ¥í•´ ë³´ì´ë˜ ê·¸ ìˆœê°„, ê·¸ëŠ” í¬ê¸°í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ìˆ˜ë§ì€ ì‹¤íŒ¨ì—ë„ ë¶ˆêµ¬í•˜ê³  ê³„ì† ë„ì „í–ˆìŠµë‹ˆë‹¤.",
                    imagePrompt: "Person facing obstacles, dramatic struggle, inspirational movie scene",
                    duration: 12
                },
                {
                    text: "ê·¸ë¦¬ê³  ë§ˆì¹¨ë‚´, ê·¸ ëª¨ë“  ë…¸ë ¥ì´ ë¹›ì„ ë°œí•˜ëŠ” ìˆœê°„ì´ ì°¾ì•„ì™”ìŠµë‹ˆë‹¤.",
                    imagePrompt: "Triumphant moment, success achievement, golden light, emotional climax",
                    duration: 10
                },
                {
                    text: "ì´ ì´ì•¼ê¸°ê°€ ì—¬ëŸ¬ë¶„ì—ê²Œë„ ì˜ê°ì´ ë˜ì—ˆìœ¼ë©´ í•©ë‹ˆë‹¤. ì ˆëŒ€ í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš”.",
                    imagePrompt: "Inspirational message, motivational ending, warm hopeful atmosphere",
                    duration: 8
                }
            ],
            review: [
                {
                    text: "ì˜¤ëŠ˜ ë¦¬ë·°í•  ì œí’ˆì„ ì†Œê°œí•©ë‹ˆë‹¤. ê³¼ì—° ì´ ì œí’ˆì´ ê°€ê²©ë§Œí¼ì˜ ê°€ì¹˜ê°€ ìˆì„ê¹Œìš”?",
                    imagePrompt: "Product unboxing scene, professional review setup, clean background",
                    duration: 8
                },
                {
                    text: "ë¨¼ì € ì™¸ê´€ë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ë””ìì¸ê³¼ ë§ˆê° í’ˆì§ˆì´ ì–´ë–¤ì§€ ìì„¸íˆ ë³´ì—¬ë“œë¦´ê²Œìš”.",
                    imagePrompt: "Close-up product details, macro photography, professional product shots",
                    duration: 12
                },
                {
                    text: "ì‹¤ì œ ì‚¬ìš©í•´ë³¸ ê²°ê³¼ë¥¼ ë§ì”€ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì¥ì ê³¼ ë‹¨ì ì„ ì†”ì§í•˜ê²Œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.",
                    imagePrompt: "Product in use, real-world testing, authentic review footage",
                    duration: 15
                },
                {
                    text: "ê²°ë¡ ì ìœ¼ë¡œ, ì´ ì œí’ˆì€ ì´ëŸ° ë¶„ë“¤ê»˜ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. êµ¬ë§¤ ì „ ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                    imagePrompt: "Final verdict screen, recommendation summary, professional review conclusion",
                    duration: 10
                }
            ]
        };

        // Load template
        function loadTemplate(type) {
            const template = templates[type];
            if (template) {
                document.getElementById('jsonEditor').value = JSON.stringify(template, null, 2);
            }
        }

        // Load background music options
        async function loadMusicOptions() {
            try {
                const response = await authFetch('/api/ai-shorts/music');
                const data = await response.json();

                if (data.success && data.music) {
                    const select = document.getElementById('bgMusic');
                    data.music.forEach(m => {
                        const option = document.createElement('option');
                        option.value = m.name;
                        option.textContent = m.displayName;
                        select.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('Error loading music:', error);
            }
        }

        // Validate JSON
        function validateJson() {
            const jsonText = document.getElementById('jsonEditor').value;
            try {
                const data = JSON.parse(jsonText);
                if (!Array.isArray(data)) {
                    alert('JSONì€ ë°°ì—´ í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
                    return false;
                }
                if (data.length === 0) {
                    alert('ìµœì†Œ 1ê°œ ì´ìƒì˜ ì”¬ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                    return false;
                }

                let totalDuration = 0;
                for (let i = 0; i < data.length; i++) {
                    if (!data[i].text || !data[i].imagePrompt) {
                        alert(`ì”¬ ${i + 1}: textì™€ imagePromptëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.`);
                        return false;
                    }
                    totalDuration += data[i].duration || 10;
                }

                alert(`âœ… JSON í˜•ì‹ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤!\nì”¬ ê°œìˆ˜: ${data.length}ê°œ\nì˜ˆìƒ ê¸¸ì´: ì•½ ${Math.ceil(totalDuration / 60)}ë¶„`);
                return true;
            } catch (e) {
                alert('âŒ JSON í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤: ' + e.message);
                return false;
            }
        }

        // Add log entry
        function addLog(message, type = 'info') {
            const log = document.getElementById('progressLog');
            const item = document.createElement('div');
            item.className = 'log-item ' + type;
            item.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(item);
            log.scrollTop = log.scrollHeight;
        }

        // Update progress
        function updateProgress(percent, status) {
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressStatus').textContent = status;
        }

        // API í‚¤ ì„¤ì • ì—¬ë¶€ ì²´í¬
        async function checkApiKeyConfigured() {
            try {
                const response = await authFetch('/api/settings/keys');
                const data = await response.json();
                return data.success && data.keys?.AI_302_API_KEY;
            } catch (e) {
                return false;
            }
        }

        // API í‚¤ ë¯¸ì„¤ì • ì‹œ ì•ˆë‚´ íŒì—…
        function showApiKeyRequiredPopup() {
            const existingPopup = document.getElementById('apiKeyRequiredPopup');
            if (existingPopup) existingPopup.remove();

            const popup = document.createElement('div');
            popup.id = 'apiKeyRequiredPopup';
            popup.style.cssText = `position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 10000;`;
            popup.innerHTML = `
                <div style="background: var(--color-bg-secondary, #fff); border-radius: 16px; padding: 2rem; max-width: 400px; width: 90%; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ”‘</div>
                    <h3 style="color: var(--color-gray-900, #333); margin-bottom: 0.75rem; font-size: 1.25rem;">302.AI API í‚¤ê°€ í•„ìš”í•´ìš”!</h3>
                    <p style="color: var(--color-gray-600, #666); font-size: 0.9rem; line-height: 1.6; margin-bottom: 1.5rem;">
                        AI ë¡±í¼ì„ ìƒì„±í•˜ë ¤ë©´ <strong>302.AI API í‚¤</strong>ê°€ í•„ìš”í•´ìš”.<br>
                        í•˜ë‚˜ì˜ í‚¤ë¡œ ëª¨ë“  AI ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                        ì˜¤ë¥¸ìª½ ìœ„ ì„¤ì • ë²„íŠ¼ì„ ëˆŒëŸ¬ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!
                    </p>
                    <div style="display: flex; gap: 0.75rem; justify-content: center;">
                        <button onclick="this.closest('#apiKeyRequiredPopup').remove()" style="padding: 0.75rem 1.5rem; border: 1px solid var(--color-gray-300, #ddd); background: transparent; border-radius: 8px; cursor: pointer; font-size: 0.9rem; color: var(--color-gray-600, #666);">ë‹«ê¸°</button>
                        <button onclick="this.closest('#apiKeyRequiredPopup').remove(); openSettingsModal();" style="padding: 0.75rem 1.5rem; background: var(--color-primary, #3b82f6); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: 600;">ì„¤ì • ì—´ê¸°</button>
                    </div>
                </div>
            `;
            document.body.appendChild(popup);
            popup.addEventListener('click', (e) => { if (e.target === popup) popup.remove(); });
        }

        // Generate longform
        async function generateLongform() {
            // API í‚¤ ì²´í¬
            const hasApiKey = await checkApiKeyConfigured();
            if (!hasApiKey) {
                showApiKeyRequiredPopup();
                return;
            }

            const jsonText = document.getElementById('jsonEditor').value;
            let scenes;

            try {
                scenes = JSON.parse(jsonText);
            } catch (e) {
                alert('JSON í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return;
            }

            if (!Array.isArray(scenes) || scenes.length === 0) {
                alert('ìµœì†Œ 1ê°œ ì´ìƒì˜ ì”¬ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            const title = document.getElementById('videoTitle').value || 'AI_Longform';
            const style = document.getElementById('imageStyle').value;
            const emotion = document.getElementById('voiceEmotion').value;
            const bgMusic = document.getElementById('bgMusic').value || null;
            const resolution = document.getElementById('resolution').value;
            const aspectRatio = document.getElementById('aspectRatio').value;

            // Show progress section
            document.getElementById('inputSection').style.opacity = '0.5';
            document.getElementById('progressSection').classList.add('active');
            document.getElementById('resultSection').classList.remove('active');
            document.getElementById('progressLog').innerHTML = '';

            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = true;
            document.getElementById('generateBtnText').style.display = 'none';
            document.getElementById('generateLoading').style.display = 'inline-block';

            addLog(`ë¡±í¼ ìƒì„± ì‹œì‘: ${scenes.length}ê°œ ì”¬`);
            updateProgress(5, 'ì„œë²„ì— ìš”ì²­ ì¤‘...');

            try {
                const response = await authFetch('/api/ai-shorts/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        scenes,
                        title,
                        style,
                        emotion,
                        bgMusic,
                        resolution,
                        aspectRatio,
                        isLongform: true
                    })
                });

                const data = await response.json();

                if (data.success) {
                    updateProgress(100, 'ì™„ë£Œ!');
                    addLog('âœ… ë¡±í¼ ìƒì„± ì™„ë£Œ!', 'success');

                    // Show result
                    document.getElementById('resultSection').classList.add('active');
                    document.getElementById('resultVideo').src = data.videoPath;
                    document.getElementById('downloadLink').href = data.videoPath;

                    document.getElementById('resultInfo').innerHTML = `
                        <p><strong>í”„ë¡œì íŠ¸:</strong> ${data.projectFolder}</p>
                        <p><strong>ì„±ê³µ:</strong> ${data.summary.successfulScenes}ê°œ ì”¬</p>
                        <p><strong>ì‹¤íŒ¨:</strong> ${data.summary.failedScenes}ê°œ ì”¬</p>
                    `;

                    // Log individual results
                    data.results.forEach(r => {
                        if (r.success) {
                            addLog(`ì”¬ ${r.scene}: ì„±ê³µ (${r.duration.toFixed(1)}ì´ˆ)`, 'success');
                        } else {
                            addLog(`ì”¬ ${r.scene}: ì‹¤íŒ¨ - ${r.error}`, 'error');
                        }
                    });
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                console.error('Error:', error);
                addLog('âŒ ì˜¤ë¥˜: ' + error.message, 'error');
                updateProgress(0, 'ì˜¤ë¥˜ ë°œìƒ');
                alert('ë¡±í¼ ìƒì„± ì‹¤íŒ¨: ' + error.message);
            } finally {
                generateBtn.disabled = false;
                document.getElementById('generateBtnText').style.display = 'inline';
                document.getElementById('generateLoading').style.display = 'none';
                document.getElementById('inputSection').style.opacity = '1';
            }
        }

        // Reset form
        function resetForm() {
            document.getElementById('progressSection').classList.remove('active');
            document.getElementById('resultSection').classList.remove('active');
            document.getElementById('jsonEditor').value = '';
            document.getElementById('progressLog').innerHTML = '';
            updateProgress(0, '');
        }

        // Update prompt preview when inputs change
        function updatePromptPreview() {
            const topic = document.getElementById('promptTopic').value || '[ì£¼ì œë¥¼ ì…ë ¥í•˜ì„¸ìš”]';
            const type = document.getElementById('promptType').value;
            const length = document.getElementById('promptLength').value;

            const prompt = `ê¸´ ìœ íŠœë¸Œ ì˜ìƒ ëŒ€ë³¸ ë§Œë“¤ì–´ì¤˜

ì£¼ì œ: ${topic}
ì˜ìƒ ì¢…ë¥˜: ${type}
ì˜ìƒ ê¸¸ì´: ${length}

ì¡°ê±´:
- ì²˜ìŒì— ê´€ì‹¬ ë„ëŠ” ë„ì…ë¶€
- ì¤‘ê°„ì— í•µì‹¬ ë‚´ìš©
- ë§ˆì§€ë§‰ì— êµ¬ë… ìœ ë„
- ê·¸ë¦¼ ì„¤ëª…ì€ ì˜ì–´ë¡œ

ì´ í˜•ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì¤˜:
[
  {
    "text": "ë„ì…ë¶€ ëŒ€ì‚¬ (2~3ë¬¸ì¥)",
    "imagePrompt": "intro scene, cinematic",
    "duration": 15
  },
  {
    "text": "ë³¸ë¡  ëŒ€ì‚¬ (3~5ë¬¸ì¥)",
    "imagePrompt": "main content scene",
    "duration": 30
  },
  {
    "text": "ë§ˆë¬´ë¦¬ ëŒ€ì‚¬",
    "imagePrompt": "closing scene",
    "duration": 15
  }
]`;
            document.getElementById('promptPreview').value = prompt;
        }

        // Copy prompt from textarea
        function copyPromptFromTextarea() {
            const textarea = document.getElementById('promptPreview');
            navigator.clipboard.writeText(textarea.value).then(() => {
                alert('ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! AIì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš” ğŸ˜Š');
            });
        }

        // Guide Modal Functions
        function openGuideModal() {
            document.getElementById('guideModal').style.display = 'flex';
        }

        function closeGuideModal() {
            document.getElementById('guideModal').style.display = 'none';
        }

        // Theme toggle
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        }

        function updateThemeIcon(theme) {
            const icon = document.getElementById('themeIcon');
            icon.textContent = theme === 'dark' ? 'â˜€ï¸ ë¼ì´íŠ¸' : 'ğŸŒ™ ë‹¤í¬';
        }

        // Initialize theme
        (function () {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                updateThemeIcon(savedTheme);
            } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                updateThemeIcon('dark');
            }
        })();

        // Mini Player
        let miniPlayerAudio = null;
        let isMiniPlayerPlaying = false;

        function onMusicChange() {
            const bgMusic = document.getElementById('bgMusic').value;
            const miniPlayer = document.getElementById('miniPlayer');

            // Stop current audio if playing
            if (miniPlayerAudio) {
                miniPlayerAudio.pause();
                miniPlayerAudio = null;
                isMiniPlayerPlaying = false;
                updateMiniPlayerIcon();
            }

            if (bgMusic) {
                miniPlayer.style.display = 'flex';
                // Create new audio element
                miniPlayerAudio = new Audio(`/audio/${bgMusic}`);
                miniPlayerAudio.addEventListener('loadedmetadata', updateMiniPlayerTime);
                miniPlayerAudio.addEventListener('timeupdate', updateMiniPlayerProgress);
                miniPlayerAudio.addEventListener('ended', () => {
                    isMiniPlayerPlaying = false;
                    updateMiniPlayerIcon();
                    miniPlayerAudio.currentTime = 0;
                    updateMiniPlayerProgress();
                });
            } else {
                miniPlayer.style.display = 'none';
            }

            // Reset progress
            document.getElementById('miniPlayerProgress').style.width = '0%';
            document.getElementById('miniPlayerTime').textContent = '0:00 / 0:00';
        }

        function toggleMiniPlayer() {
            if (!miniPlayerAudio) return;

            if (isMiniPlayerPlaying) {
                miniPlayerAudio.pause();
            } else {
                miniPlayerAudio.play();
            }
            isMiniPlayerPlaying = !isMiniPlayerPlaying;
            updateMiniPlayerIcon();
        }

        function updateMiniPlayerIcon() {
            const btn = document.getElementById('miniPlayerBtn');
            const playIcon = document.getElementById('playIcon');
            const pauseIcon = document.getElementById('pauseIcon');
            if (isMiniPlayerPlaying) {
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
                btn.classList.add('playing');
            } else {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
                btn.classList.remove('playing');
            }
        }

        function updateMiniPlayerTime() {
            if (!miniPlayerAudio) return;
            const duration = miniPlayerAudio.duration || 0;
            document.getElementById('miniPlayerTime').textContent = `0:00 / ${formatTime(duration)}`;
        }

        function updateMiniPlayerProgress() {
            if (!miniPlayerAudio) return;
            const current = miniPlayerAudio.currentTime || 0;
            const duration = miniPlayerAudio.duration || 0;
            const percent = duration > 0 ? (current / duration) * 100 : 0;
            document.getElementById('miniPlayerProgress').style.width = percent + '%';
            document.getElementById('miniPlayerTime').textContent = `${formatTime(current)} / ${formatTime(duration)}`;
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Progress bar click to seek
        document.addEventListener('DOMContentLoaded', () => {
            const progressContainer = document.querySelector('.mini-player-progress');
            if (progressContainer) {
                progressContainer.addEventListener('click', (e) => {
                    if (!miniPlayerAudio || !miniPlayerAudio.duration) return;
                    const rect = progressContainer.getBoundingClientRect();
                    const percent = (e.clientX - rect.left) / rect.width;
                    miniPlayerAudio.currentTime = percent * miniPlayerAudio.duration;
                });
            }
        });

        // Init
        loadMusicOptions();
    </script>

    <!-- Floating Buttons Container -->
    <style>
        .floating-menu {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 100;
        }

        .floating-menu-toggle {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-primary) 0%, #1d4ed8 100%);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 16px rgba(59, 130, 246, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .floating-menu-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
        }

        .floating-menu-toggle svg {
            width: 24px;
            height: 24px;
            transition: transform 0.3s ease;
        }

        .floating-menu.open .menu-icon {
            display: none;
        }

        .floating-menu.open .close-icon {
            display: block !important;
        }

        .floating-menu-items {
            position: absolute;
            bottom: 70px;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            align-items: flex-end;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .floating-menu.open .floating-menu-items {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .floating-menu-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.625rem 1rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            text-decoration: none;
            white-space: nowrap;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
            transform: translateX(20px);
            opacity: 0;
        }

        .floating-menu.open .floating-menu-item {
            transform: translateX(0);
            opacity: 1;
        }

        .floating-menu.open .floating-menu-item:nth-child(1) {
            transition-delay: 0.05s;
        }

        .floating-menu.open .floating-menu-item:nth-child(2) {
            transition-delay: 0.1s;
        }

        .floating-menu.open .floating-menu-item:nth-child(3) {
            transition-delay: 0.15s;
        }

        .floating-menu-item:hover {
            transform: translateX(-4px) !important;
        }

        .floating-menu-item svg {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }

        .float-guide {
            background: var(--color-primary);
            color: white;
            box-shadow: 0 3px 10px rgba(59, 130, 246, 0.3);
        }

        .float-telegram {
            background: #0088cc;
            color: white;
            box-shadow: 0 3px 10px rgba(0, 136, 204, 0.3);
        }

        .float-intro {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
        }

        .floating-menu-backdrop {
            position: fixed;
            inset: 0;
            z-index: 99;
            display: none;
        }

        .floating-menu.open+.floating-menu-backdrop {
            display: block;
        }
    </style>

    <!-- Floating Menu -->
    <div class="floating-menu" id="floatingMenu">
        <div class="floating-menu-items">
            <button class="floating-menu-item float-guide" onclick="openGuideModal(); toggleFloatingMenu();">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                </svg>
                <span>ì‚¬ìš©ë²•</span>
            </button>
            <a href="https://t.me/shorts_factory" target="_blank" class="floating-menu-item float-telegram"
                onclick="toggleFloatingMenu();">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z" />
                </svg>
                <span>ê³µì§€ì±„ë„</span>
            </a>
            <a href="https://shorts-factory-landing.web.app" target="_blank" class="floating-menu-item float-intro"
                onclick="toggleFloatingMenu();">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="12" y1="16" x2="12" y2="12" />
                    <line x1="12" y1="8" x2="12.01" y2="8" />
                </svg>
                <span>ì„œë¹„ìŠ¤ ì†Œê°œ</span>
            </a>
        </div>
        <button class="floating-menu-toggle" onclick="toggleFloatingMenu()" title="ë„ì›€ë§">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                stroke-linejoin="round" class="menu-icon">
                <circle cx="12" cy="12" r="10" />
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                <line x1="12" y1="17" x2="12.01" y2="17" />
            </svg>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                stroke-linejoin="round" class="close-icon" style="display:none;">
                <line x1="18" y1="6" x2="6" y2="18" />
                <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
        </button>
    </div>
    <div class="floating-menu-backdrop" onclick="toggleFloatingMenu()"></div>
    <script>
        function toggleFloatingMenu() {
            document.getElementById('floatingMenu').classList.toggle('open');
        }
    </script>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>API ì„¤ì •</h2>
                <button class="modal-close" onclick="closeSettingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- API í‚¤ ë°œê¸‰ ê°€ì´ë“œ -->
                <div
                    style="background: var(--color-bg-tertiary); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
                    <h4 style="color: var(--color-gray-900); margin-bottom: 0.75rem; font-size: 0.95rem;">ğŸ”‘ 302.AI API
                        í‚¤ ì¤€ë¹„</h4>
                    <p
                        style="color: var(--color-gray-600); font-size: 0.85rem; line-height: 1.6; margin-bottom: 0.75rem;">
                        â€¢ í•˜ë‚˜ì˜ í‚¤ë¡œ ëª¨ë“  AI ëª¨ë¸ ì‚¬ìš©<br>
                        â€¢ GPT, Claude, Gemini, DALL-E, Whisper ë“± ì§€ì›<br>
                        â€¢ ì‚¬ìš©í•œ ë§Œí¼ë§Œ ê²°ì œ (ì¢…ëŸ‰ì œ)
                    </p>
                    <p style="color: var(--color-gray-500); font-size: 0.8rem; margin: 0;">
                        API í‚¤ëŠ” <a href="https://dash.302.ai/apis/markets" target="_blank"
                            style="color: var(--color-primary);">302.AI ëŒ€ì‹œë³´ë“œ</a>ì—ì„œ ë°œê¸‰í•˜ì„¸ìš”.
                    </p>
                </div>

                <div class="form-group">
                    <label for="ai302ApiKey">302.AI API Key</label>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="password" id="ai302ApiKey" placeholder="sk-..." style="flex: 1;">
                        <button class="btn btn-sm" onclick="toggleKeyVisibility('ai302ApiKey')">ğŸ‘ï¸</button>
                    </div>
                    <small style="color: var(--color-gray-500);">ì´ë¯¸ì§€ ìƒì„± (DALL-E)ê³¼ ëª¨ë“  AI ê¸°ëŠ¥ì— ì‚¬ìš©ë©ë‹ˆë‹¤.</small>
                </div>

                <div class="form-group" style="margin-top: 1.5rem;">
                    <div style="display: flex; gap: 0.75rem; flex-wrap: wrap; align-items: center;">
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <button class="btn" onclick="test302AIConnection()" id="test302AIBtn">302.AI í…ŒìŠ¤íŠ¸</button>
                            <span id="ai302TestResult" style="margin-left: 0.5rem;"></span>
                        </div>
                    </div>
                </div>

                <!-- í…Œë§ˆ ì„¤ì • -->
                <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--color-gray-200);">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <label style="font-weight: 600; color: var(--color-gray-900);">í™”ë©´ í…Œë§ˆ</label>
                            <p style="font-size: 0.8rem; color: var(--color-gray-500); margin-top: 0.25rem;">ë¼ì´íŠ¸/ë‹¤í¬ ëª¨ë“œë¥¼
                                ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                        <button onclick="toggleTheme()" id="themeToggleBtn"
                            style="display: flex; align-items: center; gap: 0.5rem; padding: 0.6rem 1rem; background: var(--color-bg-tertiary); border: 1px solid var(--color-gray-300); border-radius: 8px; cursor: pointer; font-size: 0.85rem; color: var(--color-gray-700); font-weight: 500;">
                            <span id="themeIcon">ğŸŒ™ ë‹¤í¬</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSettingsModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="saveSettings()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        // Settings Modal Functions
        async function openSettingsModal() {
            document.getElementById('settingsModal').style.display = 'flex';
            document.getElementById('ai302TestResult').textContent = '';
            try {
                const response = await authFetch('/api/settings/keys');
                const data = await response.json();
                if (data.success) {
                    document.getElementById('ai302ApiKey').placeholder = data.keys.AI_302_API_KEY || 'sk-...';
                }
            } catch (e) {
                console.error('Failed to load keys:', e);
            }
        }

        function closeSettingsModal() {
            document.getElementById('settingsModal').style.display = 'none';
            document.getElementById('ai302ApiKey').value = '';
        }

        function toggleKeyVisibility(inputId) {
            const input = document.getElementById(inputId);
            input.type = input.type === 'password' ? 'text' : 'password';
        }

        async function test302AIConnection() {
            const btn = document.getElementById('test302AIBtn');
            const result = document.getElementById('ai302TestResult');
            const apiKey = document.getElementById('ai302ApiKey').value;
            btn.disabled = true;
            result.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            result.style.color = 'var(--color-gray-500)';
            try {
                const response = await authFetch('/api/settings/test-302ai', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ apiKey: apiKey || undefined })
                });
                const data = await response.json();
                if (data.success) {
                    result.textContent = 'âœ“ ì—°ê²° ì„±ê³µ!';
                    result.style.color = 'var(--color-success)';
                } else {
                    result.textContent = data.error || 'ì—°ê²° ì‹¤íŒ¨';
                    result.style.color = 'var(--color-error)';
                }
            } catch (e) {
                result.textContent = 'í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ' + e.message;
                result.style.color = 'var(--color-error)';
            }
            btn.disabled = false;
        }

        async function saveSettings() {
            const ai302Key = document.getElementById('ai302ApiKey').value.trim();
            if (!ai302Key) {
                alert('302.AI API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            try {
                const response = await authFetch('/api/settings/keys', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ AI_302_API_KEY: ai302Key })
                });
                const data = await response.json();
                if (data.success) {
                    alert('API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    closeSettingsModal();
                    location.reload();
                } else {
                    alert('ì €ì¥ ì‹¤íŒ¨: ' + data.error);
                }
            } catch (e) {
                alert('ì €ì¥ ì‹¤íŒ¨: ' + e.message);
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeSettingsModal();
                closeGuideModal();
            }
        });

        document.getElementById('settingsModal').addEventListener('click', (e) => {
            if (e.target.id === 'settingsModal') closeSettingsModal();
        });

        document.getElementById('guideModal').addEventListener('click', (e) => {
            if (e.target.id === 'guideModal') closeGuideModal();
        });
    </script>

    <!-- Firebase Auth -->
    <script src="/js/firebase-config.js"></script>
    <script src="/js/firebase-auth.js"></script>
    <script>
        // Check authentication
        requireAuth().then(authState => {
            if (authState) {
                document.body.style.visibility = 'visible';
                startTokenRefresh();

                // Update header auth UI
                setHeaderAuthState(authState);

                // Add admin link if user is admin
                if (authState.isAdmin) {
                    const nav = document.querySelector('.header-nav');
                    if (nav && !nav.querySelector('[href="/admin"]')) {
                        const adminLink = document.createElement('a');
                        adminLink.href = '/admin';
                        adminLink.innerHTML = '<span>ê´€ë¦¬ì</span>';
                        nav.appendChild(adminLink);
                    }
                }
            }
        });
    </script>
</body>

</html>